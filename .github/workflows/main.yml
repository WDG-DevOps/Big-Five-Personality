# Nama workflow Anda
name: CI Docker Build and Push

# Tentukan kapan workflow ini berjalan:
# Yaitu setiap kali ada 'push' ke branch 'main'
on:
  push:
    branches: [ "main" ]

# Daftar pekerjaan yang harus dilakukan
jobs:
  build-and-push:
    # Gunakan server Linux (Ubuntu) terbaru dari GitHub
    runs-on: ubuntu-latest

    steps:
      # Langkah 1: 'Checkout' (mengunduh) kode Anda ke server
      - name: Checkout code
        uses: actions/checkout@v4

      # Langkah 2: Login ke Docker Hub menggunakan 'Secrets'
      - name: Login to Docker Hub
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}

      # Langkah 3: Build dan Push Docker image
      - name: Build and push Docker image
        uses: docker/build-push-action@v5
        with:
          # 'context: .' berarti Dockerfile ada di root folder
          context: .
          file: ./Dockerfile
          # 'push: true' berarti akan di-push ke registry
          push: true
          # 'tags' adalah nama image Anda di Docker Hub
          # GANTI 'username-anda' dengan username Docker Hub Anda!
          tags: apanyaclay/bigfive-app:latest